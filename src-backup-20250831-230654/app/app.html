<!-- PROJECT ANALYTICS V2 - –ì–õ–ê–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï –° –ù–ê–í–ò–ì–ê–¶–ò–ï–ô -->

<!-- ANIMATED 3D LANDSCAPE BACKGROUND -->
<app-animated-landscape
  [config]="{
    gridSize: 100,
    animationSpeed: 0.8,
    waveAmplitude: 2.0,
    particleSize: 2.5,
    colorScheme: 'wone-it',
    enableDroplets: true,
    quality: 'high',
    landscapeHeight: 5,
    cameraDistance: 10,
    cameraAngle: 'diagonal'
  }"
  [autoStart]="true"
  [showControls]="false"
  [showPerformanceMonitor]="false"
  [enableUserInteraction]="false"
  (initialized)="onLandscapeInitialized($event)"
  (performanceUpdate)="onPerformanceUpdate($event)"
></app-animated-landscape>

<div class="app-layout">
  
  <!-- –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ –° –Ø–ó–´–ö–û–í–´–ú –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–ï–ú -->
  <header class="app-topbar">
    <div class="topbar-content">
      <h1 class="app-title">
        Project Analytics V2
      </h1>
      
      <!-- –°—Ç–∞—Ç—É—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ -->
      @if (initializationStatus()) {
        <div class="init-status">
          {{ initializationStatus() }}
        </div>
      }
      
      <!-- –î–µ–±–∞–≥ –∫–Ω–æ–ø–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) -->
      <div class="debug-controls" style="display: flex; gap: 0.5rem; margin-right: 1rem;">
        <button 
          (click)="debugShowConfig()"
          class="debug-btn"
          title="–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"
        >
          üìä
        </button>
        <button 
          (click)="debugSaveConfig()"
          class="debug-btn"
          title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î"
        >
          üíæ
        </button>
      </div>
      
      <!-- –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å -->
      <div class="language-switcher">
        <button 
          (click)="toggleLanguage()"
          class="lang-toggle-btn"
          [class.active]="currentLang() === 'ru'"
        >
          {{ currentLang() === 'ru' ? 'ENG' : '–†–£–°' }}
        </button>
      </div>
    </div>
  </header>

    <!-- –ü–û–ö–ê–ó–´–í–ê–ï–ú –ö–û–ù–¢–ï–ù–¢ –¢–û–õ–¨–ö–û –ü–û–°–õ–ï –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò -->
  @if (isInitialized()) {
    
    <!-- –ë–û–ö–û–í–û–ï –ú–ï–ù–Æ -->
    <nav class="app-sidebar">
      <ul class="nav-menu">
        <li class="nav-item">
          <a routerLink="/dashboard" class="nav-link" routerLinkActive="active">
            <span class="nav-icon">üìä</span>
            <span class="nav-text">{{ currentLang() === 'ru' ? '–î–∞—à–±–æ—Ä–¥' : 'Dashboard' }}</span>
          </a>
        </li>
        <li class="nav-item">
          <a routerLink="/reports/time-entries" class="nav-link" routerLinkActive="active">
            <span class="nav-icon">‚è∞</span>
            <span class="nav-text">{{ currentLang() === 'ru' ? '–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏' : 'Time Entries' }}</span>
          </a>
        </li>
        <li class="nav-item">
          <a routerLink="/settings" class="nav-link" routerLinkActive="active">
            <span class="nav-icon">‚öôÔ∏è</span>
            <span class="nav-text">{{ currentLang() === 'ru' ? '–ù–∞—Å—Ç—Ä–æ–π–∫–∏' : 'Settings' }}</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
    <main class="app-content">
      <router-outlet></router-outlet>
</main>

  } @else {
    
    <!-- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò -->
    <div class="loading-screen">
      <div class="loading-card glass-card">
        <h2>{{ currentLang() === 'ru' ? 'üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã...' : 'üîÑ System initialization...' }}</h2>
        <p>{{ currentLang() === 'ru' ? '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö' : 'Loading configuration from database' }}</p>
        <div class="loading-spinner"></div>
      </div>
    </div>
    
  }

</div>

<!-- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø -->
<app-notifications></app-notifications>